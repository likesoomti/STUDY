# chap02 안드로이드 프로젝트 이해



## 안드로이드 앱 개발 특징

1. 안드로이드의 특징

- 리눅스 기반

- 자바 / 코틀린 

- 대부분의 코드가 오픈소스

- 다양한 방법으로 사용자에게 배포할 수 있다. 

- 단점 : 파편화

  스마트폰 제조사가 안드로이드를 약간 커스텀하여 탑재시, 내가 만든 코드가 안돌아갈 수 있다. 

- 특징 - 멀티태스킹

  여러 프로세스를 사용한다 (ios 는 불가)



## 안드로이드 플랫폼 아키텍쳐

여러 레이어로 구성된다. 

1. 리눅스 커널 기반

2. HAL

   자바 API 프레임워크에 하드웨어 기능을 이용하는 표준 인터페이스를 제공한다. 

3. 안드로이드 런 타임 

   ART 가상 머신을 이용하여, API 프레임워크에서 제공하는 다양한 클래스를 이용해 앱을 개발한다.

   달빅을 대체하고 ART 를 사용하여 자바 언어를 컴파일한다. 

4. 애플리케이션 프레임워크

   안드로이드 개발을 할때 개발자들이 사용하는 표준 라이브러리. 



## 컴포넌트 기반 개발

##### 컴포넌트

앱의 구성단위. 

여러 컴포넌트를 조합해 하나의 앱을 완성한다. 

앱의 `.class` 는 컴포넌트와 일반 클래스로 나뉜다. 

안드로이드 컴포넌트는 안드로이드 시스템이 생성하여 관리하다 소멸한다. 

일반 클래스는 개발자 코드에서 직접 생명주기를 관리한다.

##### 컴포넌트는 앱 내에서 독립적인 실행 단위이다.

컴포넌트 클래스는 독립적인 수행 단위로 동작한다. 

아키텍쳐의 `느슨한 결합` 도를 나타낸다. 

```java
// 일반 
class A {
    main(){
        B b1 = new B(); // A 클래스는 B 클래스에 직접 결합 되어:ㅆ다. 
    }
}

// 안드로이드 컴포넌트 인 경우 직접 실행 불가능하고.
// intent 라는 매개를 통해 독립적으로 실행한다. 
```

##### main 함수 같은 애플리케이션 진입 지점이 없다.

컴포넌트 클래스들은 모두 프로세스가 구동될 시 최초로 실행되는 수행 시점이 될 수 있다. 

안드로이드는 아이콘 버튼을 눌렀을때만 실행되는게 아니라, 다르게 실행될 수 있다. 

ex) 인스타그램 누가 좋아요 누를시 알림 뜨는것 처럼 , 메세지 수신시 수신 컴포넌트가 실행된다. 

따라서 앱 수행 시점은 다양하고, 독립적으로 구성된다.

##### 애플리케이션 라이브러리 개념이 있다. 

카톡에서 사진을 보낼시, 갤러리가 연동되어서 갤러리 앱을 실행해 사진을 꺼내온다. 

이게 가능한 이유는 안드로이드는 컴포넌트 기반이기 때문에, 두 클래스가 직접 결합되지 않아도, 외부 앱에서 프로세스를 실행 해 연동이 가능하다.



## 안드로이드 컴포넌트 종류

- 액티비티

  사용자 화면을 제공한다. 

- 서비스

  화면 없이, 백그라운드에서 무언가 수행하는 공간이다. ex) 채팅

- 콘텐츠 프로바이더

  앱 간의 데이터 공유 목적 컴포넌트. 카톡 사진, 전화 주소록 등 

- 브로드캐스트 리시버 

  이벤트 모델로 수행. sms 문자가 온경우 필요한 어플에 알아서 전달해준다.



## 리소스를 이용한 개발

리소스 외부화를 극대화해서 개발한다.

- 리소스 외부화

  항상 같은 결과가 나오는 정적인 콘텐츠를 코드에서 분리해서 개발하는 것 

sample

```java
textView.setText("	rubypaper-android");

```

리소스 외부화 이후 

```xml
<resources>
  <string name="app_name">
  	rubypaper-android
  </string>
</resources>
```

장점

1. 코드 영역과 정적인 부분이 분리되어 유지보수하기 좋다. 
2. 안드로이드는 문자열 뿐만 아니라, 정적인 부분이면 `xml` 파일로 분리해서 개발하는 특징이 있다.
3. UI도 xml 로 작성하는 것 또한 리소스 외부화 차원중의 하나이다.
4. 문자열, 크기, 색상,, 레이아웃, 메뉴, 에니메이션 등 여러 특징이 있다.



## 개발 디렉터리와 파일 구조

`src/main`

개발자와 관련된 폴더. 이곳의 파일을 통해 개발한다.

- anroidManifest.xml : 앱의 메인 환경 파일
- java/MainActivity.java : 화면 구성을 위한 액티비티 컴포넌트
- res : 앱의 리소스파일
- res/drawable :리소스 파일 중 이미지를 저장하기 위한 폴더
- res/layout : 리소스 중 ui 구성을 위한 xml 파일을 위한 폴더
- res/mipmap : 리소스 중 앱의 아이콘 이미지를 위한 폴더
- res/value: 리소스 중 문자열 값들을 위한 폴더 



개발자가 작성하는 java 파일은 `java` 폴더에, 리소스 파일은 `res`  파일에 위치한다.



## R.java 의 이해

리소스와 관련된 파일들은 `res` 파일 하위에 위치한다. 

- 하위 폴더는 이름이 지정되어있다.
- 폴더 안에 서브 폴더를 만들 수 없다.

이러한 문제로, 수백개의 리소스가 만들어질 경우, 식별할 방법이 필요하다.

따라서 안드로이드에서는 `R.java` 를 통해 파일을 자동으로 만들어준다. 

만약에 리소스 파일이 추가된다면, R.java 에는 이 리소스를 식별하기 위한 변수가 자동으로 추가된다.

따라서 `R.폴더.파일` 의 변수로 리소스를 식별해서 사용한다. 



## 그레들 파일

개발 후 사용자에게 어플을 배고파려면 빌드 작업이 필요하다.

앱에 포함된 리소스/자바 코드를 컴파일하고, 준비된 키로 서명해 apk 파일을 추출하는데,

안드로이드는 이때 `gradle` 을 이용한다. 

build.gradle

이 파일에서 그레이들 관련 설정을 한다. 

프로젝트/ 모듈 수준으로 구분된다.

앱이 모듈 단위이며, 여러 모듈을 묶어 관리하는 것이 프로젝트이다. 

모듈 하나당 그래들 파일이 만들어진다. 

settings.gradle

그래들이 관리하고 빌드해야 하는 모듈이 등록되어 있다.

```java
include ':app'
```

여러 모듈을 만들어 개발하면, 모듈명이 자동으로 settings.gradle 에 포함된다.

## 프로젝트 수준의 그레들

build.gradle

최상위에있는 파일 . 

모든 모듈에 대한 최상위 설정을 목적으로 한다. 

## 모듈 수준의 그레이들

모듈 수준의 그레들 파일은 모듈을 개발하고 빌드 할 때 중요한 역할을 한다

- compileSDKVersion

  빌드시 이용되는 툴 정보

- applicationId "com.example.user.androidlab"

  앱의 식별자. 유일 무이한 단어로 주어야 한다. 

- minSdkVersion

  최소 지원 범위

- targetSdkVersion

  사용하고있는 SDK 버전

- versionCode

  앱의 버전 